name: Publish Helm Release

on:
  push:
    branches: [ master ]
    #paths:
    #  - "charts/air-tracker-app/**"
  pull_request:
    branches: [ master ]

jobs:
  build-helm:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v2

    - name: Publish Frontend Helm charts
      uses: stefanprodan/helm-gh-pages@master
      with:
        token: ${{ secrets.GH_TOKEN }}
        charts_dir: ./charts/air-tracker-app
        target_dir: ./air-tracker-app
        owner: wojcikmm
        repository: helm-repo
        branch: master
        commit_username: wojcikmm
        
    - name: Publish Backend Helm charts
      uses: stefanprodan/helm-gh-pages@master
      with:
        token: ${{ secrets.GH_TOKEN }}
        charts_dir: ./charts/air-tracker-api
        target_dir: ./air-tracker-api
        owner: wojcikmm
        repository: helm-repo
        branch: master
        commit_username: wojcikmm     
      
   
